<!doctype html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0" />
    <meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
    <title>底部导航</title>
    <link rel="stylesheet" type="text/css" href="../css/api.css" />
    <link rel="stylesheet" type="text/css" href="../css/style.css" />
    <link rel="stylesheet" type="text/css" href="../css/aui.css" />
    <link rel="stylesheet"type="text/css" href="../feature/fonts/iconfont.css"/>
    <style>
        * {
            padding: 0;
            margin: 0;

        }
        body{
          height: 100%;
          overflow: hidden;
        }
        /*框架*/
        #slip{
          transform: translate3d(0px, 0px, 0px);


        }
        .swipe-wrap {
            width: 100%;
            height: 100%;
            position: relative;
            overflow: hidden;
        }

        .swipe {
            position: absolute;
            width: 100%;
            height: auto;
        }

        .swipe-box {
            width: 100%;
            overflow: hidden;
        }
        .video_max{
          display: block;
     width: 100%;
     height: 100%;
     /*object-fit: fill;*/
     object-fit: cover;
        }
        #aui-header{
         background: -webkit-linear-gradient(rgba(0, 0, 0, 0.3), rgba(255,255,255,0.1)); /* Safari 5.1 - 6.0 */
  background: -o-linear-gradient(rgba(0, 0, 0, 0.3), rgba(255,255,255,0.1)); /* Opera 11.1 - 12.0 */
  background: -moz-linear-gradient(rgba(0, 0, 0, 0.3), rgba(255,255,255,0.1)); /* Firefox 3.6 - 15 */
  background: linear-gradient(rgba(0, 0, 0, 0.3), rgba(255,255,255,0.1)); /* 标准的语法 */
  position: fixed;
  top:0
        }
        #aui-header>.aui-pull-left>.camera-text {
            font-size: 10px;
            padding-left: .5vh;
            padding-top: .5vh;
            font-family: '微软雅黑';
        }

        #aui-header>.aui-title>.aui-tab {
            background-color: rgba(0, 0, 0, 0);
        }

        #aui-header>.aui-title>.aui-tab>.aui-tab-item {
            color: #fff;
        }

        #aui-header>.aui-title>.aui-tab>.aui-active {
            border-bottom: none;
            font-weight: bold;
            font-size: 18px;
            color: #fff;
        }

        #aui-header>.aui-title>.aui-tab>#page_aui {
            height: 2vh;
            width: .7vh;
            margin-top: 2vh;
            background: #fff;
        }
        #showPlay{
          height: 100%;
          background: rgba(0, 0, 0, 0.3);
          z-index:45
        }
        #showPlay>span{
          margin-top: 60%;
    margin-left: 40%;
    line-height: 8vh;
    font-size: 5rem;
        }
    </style>

</head>

<body>
  <header id="aui-header" class="aui-bar aui-bar-nav">
      <div class="aui-pull-left aui-btn" onclick="openCamera()">
          <span class="aui-iconfont aui-icon-camera"></span>
          <span class="camera-text">随拍</span>
      </div>
      <div class="aui-title">
          <div class="aui-tab">
              <div class="aui-tab-item tapmode aui-active" onclick="switchLoading(this,'html/frame0.html','homelist')">推荐</div>
              <span id="page_aui"></span>
              <div class="aui-tab-item tapmode" onclick="switchLoading(this,'html/local.html','localList')">广州</div>
          </div>
      </div>
      <div class="aui-pull-right aui-btn">
          <span class="aui-iconfont aui-icon-cart"></span> &nbsp; &nbsp; &nbsp;
          <span class="aui-iconfont aui-icon-video"></span> &nbsp;&nbsp;
      </div>
  </header>
  <div id="showPlay" style="display:none" onclick="showPlay()">
    <span class="iconfont icon-douyinkuaishou"></span>
  </div>
    <div class="swipe-wrap" id="slip">
        <article class="swipe">



        </article>
    </div>

</body>
</html>
<script type="text/javascript" src="../script/api.js"></script>
<script type="text/javascript" src="../script/slip.js"></script>
<script type="text/javascript">
var container = document.getElementById('slip');
var pages;
  var slip;
var  userData = [{
      uid : new Date().getTime()+1,
      imageUrl :'http://7z2dc9.com1.z0.glb.clouddn.com/apicloud/bc281dfcaf750de7acd9c8e9224e237b.png',
      videoUrl : 'http://7z2dc9.com1.z0.glb.clouddn.com/apicloud/abb9595e74647defe21d748e12f7a7c9.mp4',
  },{
      uid : new Date().getTime()+2,
      imageUrl :'http://7z2dc9.com1.z0.glb.clouddn.com/apicloud/1a73dd6a90a52b2aad1aafefbf977e4c.png',
      videoUrl : 'http://7z2dc9.com1.z0.glb.clouddn.com/apicloud/00b2141bff87cfaa75498f66214aeb9e.mp4',
  },{
      uid : new Date().getTime()+3,
      imageUrl :'http://7z2dc9.com1.z0.glb.clouddn.com/apicloud/ec65083dbdc6bb18a6318591ac6c15a5.png',
      videoUrl : 'http://7z2dc9.com1.z0.glb.clouddn.com/apicloud/9d9906ba474152307d7edca6bd72fbe2.mp4',
  },{
      uid : new Date().getTime()+4,
      imageUrl :'http://7z2dc9.com1.z0.glb.clouddn.com/apicloud/51fc1ddde9790c96a6986b74342a15e3.png',
      videoUrl : 'http://7z2dc9.com1.z0.glb.clouddn.com/apicloud/dc811d2c4d88b409063c7ea2065fe6a0.mp4',
  },{
      uid : new Date().getTime()+5,
      imageUrl :'http://7z2dc9.com1.z0.glb.clouddn.com/apicloud/51fc1ddde9790c96a6986b74342a15e3.png',
      videoUrl : '../res/src/test.mp4',
  }];
  var page = 0;
  function showPlay(){
    document.getElementById('showPlay').style.display = 'none';
    document.getElementById(userData[page].uid).play();
  }
apiready = function(){
  var header = $api.byId('aui-header');
  $api.fixStatusBar(header)
  userData.map(function(v,i) {
    var el = document.createElement('div');
    el.className = 'swipe-box';
    var el_child=document.createElement('video');
    el_child.src = v.videoUrl;
    el_child.id=v.uid;
    el_child.prop = v.imageUrl;
    el_child.autoplay = i==0?true:false;
    el_child.loop = true;
    el_child.className ='video_max';
    // el_child.onclick='this.paused = !this.paused';
      // el_child.onclick='showC(this)';
      // el.onclick='showC(this)';
    el.appendChild(el_child);
    container.appendChild(el);
  })
pages=document.querySelectorAll('.swipe-box')
slip = Slip(container, 'y').webapp(pages);
api.addEventListener({
    name:'tap'
}, function(ret, err){
   console.log(document.getElementById(userData[page].uid).paused)
  //  document.getElementById(userData[page].uid).controls = true;
   if(!document.getElementById(userData[page].uid).paused){
   document.getElementById(userData[page].uid).pause();
     document.getElementById('showPlay').style.display = 'block';
 }
 // else {
 //     document.getElementById(userData[page].uid).play();
 //     document.getElementById('showPlay').style.display = 'none';
    //  document.getElementById(userData[page].uid).controls = false;
  //  }
});
slip.start(function(event) {
      // console.log('start');
      page = this.page;
      // 事件对象
      // console.log(JSON.stringify(event));
      // 当前坐标值
      // console.log(JSON.stringify(userData[this.page]));
      if(!document.getElementById(userData[this.page].uid).paused)
      document.getElementById(userData[this.page].uid).pause();
    })
    .move(function(event) {
      // console.log('move');
    })
    .end(function() {
        page = this.page;
      // console.log('end');
      // console.log(JSON.stringify(this.page));
      if(document.getElementById(userData[this.page].uid).paused)
        document.getElementById(userData[this.page].uid).play();

      // 滑动方向
      // console.log(this.orient);
    });
}
function showC(d){
  console.log(d.childNode)
  d.controls = true;
  d.paused = !d.pasused;
}
function switchLoading(obj,url,text){
  var frames = api.frames();
  for (var i = 0; i < frames.length; i++) {
      api.closeFrame({
          name: frames[i].name,
      })
  }
  var header = $api.byId('aui-header');
var param = api.pageParam.footer;
  var headerPos = $api.offset(header);
  var body_h = api.winHeight;
  var footer_h = param;
  var headerAct = $api.dom(header, '.aui-bar-tab-item.aui-active');
  $api.removeCls(headerAct, 'aui-active');
  $api.addCls(obj, 'aui-active');
  api.openFrame({
      name: text,
      url: url,
      rect: {
        x: 0,
        y: headerPos.h,
        w: 'auto',
        h: body_h - headerPos.h - footer_h
      },
      pageParam: {
          top: headerPos.h,
          height: body_h - headerPos.h - footer_h
      },
      bounces: true,
      bgColor: 'rgba(0,0,0,0)',
      vScrollBarEnabled: true,
      hScrollBarEnabled: true
  });
  setTimeout(function() {
     var frames = api.frames();
      console.log(JSON.stringify(frames))
      // for (var i = 0; i < frames.length; i++) {

      api.sendFrameToBack({ from: text });
      console.log(JSON.stringify(frames))
      // }
     },1000)
}

</script>
