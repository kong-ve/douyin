<!doctype html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0" />
    <meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
    <title>底部导航</title>
    <link rel="stylesheet" type="text/css" href="./css/api.css" />
    <link rel="stylesheet" type="text/css" href="./css/style.css" />
    <link rel="stylesheet" type="text/css" href="./css/aui.css" />
    <style>

        #footer {
            background-color: #000 !important;
            position: fixed;
            bottom: 0;
            z-index: 999999;
        }

        #aui-header>.aui-pull-left>.camera-text {
            font-size: 10px;
            padding-left: .5vh;
            padding-top: .5vh;
            font-family: '微软雅黑';
        }

        #aui-header>.aui-title>.aui-tab {
            background-color: rgba(0, 0, 0, 0);
        }

        #aui-header>.aui-title>.aui-tab>.aui-tab-item {
            color: #fff;
        }

        #aui-header>.aui-title>.aui-tab>.aui-active {
            border-bottom: none;
            font-weight: bold;
            font-size: 18px;
            color: #fff;
        }

        #aui-header>.aui-title>.aui-tab>#page_aui {
            height: 2vh;
            width: .7vh;
            margin-top: 2vh;
            background: #fff;
        }

        #footer>#tabbar5>.center-nav {
          border: .5px solid #fff;
  padding: .1vh 2.5vh;
  border-radius: 18%;
  background-color: #ffffff;
  font-size: larger;
  font-weight: bold;
  color: #000;
  z-index: 99999 !important;
  max-width: 1vh;
        }

        #footer>.aui-active {
            color: #fff;
            padding-right: .3vh;
        }

        #footer>.aui-active>.aui-bar-tab-label>span {
            border-bottom: 1px solid #fff;
            padding-bottom: 1vh;
        }

        #footer>#tabbar5>.aui-iconfont {
            position: relative;
            background-color: #fff;
            z-index: 20;
            top: 0.1rem;
            height: 1.2rem;
            font-size: 1rem;
            line-height: 1rem;
            color: #000;
            font-weight: bold;
        }

        #main {
            z-index: -1;
        }
    </style>
</head>

<body>
    <header id="aui-header" class="aui-bar aui-bar-nav">
        <div class="aui-pull-left aui-btn" onclick="openCamera()">
            <span class="aui-iconfont aui-icon-camera"></span>
            <span class="camera-text">随拍</span>
        </div>
        <div class="aui-title">
            <div class="aui-tab">
                <div class="aui-tab-item tapmode aui-active" onclick="switchLoading(this,'html/frame0.html','homelist')">推荐</div>
                <span id="page_aui"></span>
                <div class="aui-tab-item tapmode" onclick="switchLoading(this,'html/local.html','localList')">广州</div>
            </div>
        </div>
        <div class="aui-pull-right aui-btn">
            <span class="aui-iconfont aui-icon-cart"></span> &nbsp; &nbsp; &nbsp;
            <span class="aui-iconfont aui-icon-video"></span> &nbsp;&nbsp;
        </div>
    </header>
    <div id="main" class="flex-con">

    </div>
    <footer class="aui-bar aui-bar-tab nav-dom" id="footer">
        <div id="tabbar1" class="aui-bar-tab-item aui-active" tapmode onclick="randomSwitchBtn(this,'html/frame0.html',0)">
            <!-- <i class="aui-iconfont aui-icon-home"></i> -->
            <div class="aui-bar-tab-label"><span>云API</span></div>
        </div>
        <div id="tabbar2" class="aui-bar-tab-item" tapmode onclick="randomSwitchBtn(this,'html/frame1.html',1)">
            <!-- <i class="aui-iconfont aui-icon-star"></i> -->
            <div class="aui-bar-tab-label"><span>端API</span></div>
        </div>
        <div id="tabbar5" class="aui-bar-tab-item" tapmode>
            <i class="center-nav">+</i>
        </div>
        <div id="tabbar3" class="aui-bar-tab-item" tapmode onclick="randomSwitchBtn(this,'html/frame1.html',2)">
            <!-- <div class="aui-badge">99</div> -->
            <!-- <i class="aui-iconfont aui-icon-cart"></i> -->
            <div class="aui-bar-tab-label"><span>开发</span></div>
        </div>
        <div id="tabbar4" class="aui-bar-tab-item" tapmode onclick="randomSwitchBtn(this,'html/frame1.html',3)">
            <!-- <div class="aui-dot"></div> -->
            <!-- <i class="aui-iconfont aui-icon-my"></i> -->
            <div class="aui-bar-tab-label"><span>文档</span></div>
        </div>
    </footer>
</body>

</html>
<script type="text/javascript" src="script/api.js"></script>
<script type="text/javascript">
    apiready = function() {
        api.parseTapmode();
        var header = $api.byId('aui-header');
        var footer = 　$api.byId('footer')
        $api.fixStatusBar(header);
        var headerPos = $api.offset(header);
        var body_h = api.winHeight;
        var footer_h = $api.offset(footer).h;
        // var main = $api.first($api.dom('#main'));
        // console.log(JSON.stringify(main));
        //body_h - headerPos.h - footer_h
        api.openFrame({
            name: 'home',
            url: 'html/header_local.html',
            rect: {
                x: 0,
                y: headerPos.h,
                w: 'auto',
                h: body_h - headerPos.h - footer_h,
                'z-index':1
            },
            pageParam: {
                top: headerPos.h,
                height: body_h - headerPos.h - footer_h
            },
            bounces: true,
            bgColor: 'rgba(0,0,0,0)',
            vScrollBarEnabled: false,
            hScrollBarEnabled: false
        });
        setTimeout(function() {
           var frames = api.frames();
            // console.log(JSON.stringify(frames))
            // for (var i = 0; i < frames.length; i++) {
             // console.log(window.childNode)
            api.sendFrameToBack({ from: 'home' });
            // }
           },1000)


    }

    function closeWin() {
        api.closeWin();
    }

    function openCamera() {
        api.getPicture({
            sourceType: 'camera',
            encodingType: 'jpg',
            mediaValue: 'pic',
            destinationType: 'url',
            allowEdit: true,
            quality: 50,
            targetWidth: 100,
            targetHeight: 100,
            saveToPhotoAlbum: false
        }, function(ret, err) {
            if (ret) {
                alert(JSON.stringify(ret));
            } else {
                alert(JSON.stringify(err));
            }
        });
    }
    function switchLoading(obj,url,text){
      var frames = api.frames();
      for (var i = 0; i < frames.length; i++) {
          api.closeFrame({
              name: frames[i].name,
          })
      }
      var header = $api.byId('aui-header');
      var footer = 　$api.byId('footer')
      var headerPos = $api.offset(header);
      var body_h = api.winHeight;
      var footer_h = $api.offset(footer).h;
      var headerAct = $api.dom(header, '.aui-bar-tab-item.aui-active');
      $api.removeCls(headerAct, 'aui-active');
      $api.addCls(obj, 'aui-active');
      api.openFrame({
          name: text,
          url: url,
          rect: {
            x: 0,
            y: headerPos.h,
            w: 'auto',
            h: body_h - headerPos.h - footer_h
          },
          pageParam: {
              top: headerPos.h,
              height: body_h - headerPos.h - footer_h
          },
          bounces: true,
          bgColor: 'rgba(0,0,0,0)',
          vScrollBarEnabled: true,
          hScrollBarEnabled: true
      });
      setTimeout(function() {
         var frames = api.frames();
          console.log(JSON.stringify(frames))
          // for (var i = 0; i < frames.length; i++) {

          api.sendFrameToBack({ from: text });
          console.log(JSON.stringify(frames))
          // }
         },1000)
    }

    function randomSwitchBtn(obj, url, index) {
        // $api.text($api.byId('aui-header'), name);
        var frames = api.frames();
        for (var i = 0; i < frames.length; i++) {
            api.closeFrame({
                name: frames[i].name,
            })
        }
        var header = $api.byId('aui-header');
        var footer = 　$api.byId('footer')
        var headerPos = $api.offset(header);
        var body_h = api.winHeight;
        var footer_h = $api.offset(footer).h;
        var footerAct = $api.dom(footer, '.aui-bar-tab-item.aui-active');
        $api.removeCls(footerAct, 'aui-active');
        $api.addCls(obj, 'aui-active');
        api.openFrame({
            name: index,
            url: url,
            rect: {
              x: 0,
              y: headerPos.h,
              w: 'auto',
              h: body_h - headerPos.h - footer_h
            },
            pageParam: {
                top: headerPos.h,
                height: body_h - headerPos.h - footer_h
            },
            bounces: true,
            bgColor: 'rgba(0,0,0,0)',
            vScrollBarEnabled: true,
            hScrollBarEnabled: true
        });
        setTimeout(function() {
           var frames = api.frames();
            console.log(JSON.stringify(frames))
            // for (var i = 0; i < frames.length; i++) {
             // console.log(window.childNode)
            api.sendFrameToBack({ from: text });
            // }
           },1000)
    }
</script>
